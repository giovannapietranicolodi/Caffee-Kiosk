<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Spinner?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="800.0" prefWidth="1280.0" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controller.CaffeeController">
    <left>
        <VBox fx:id="categoryPanel" minWidth="150.0" prefWidth="150.0" spacing="10.0" style="-fx-padding: 10; -fx-border-color: lightgrey; -fx-border-width: 0 1 0 0;">
            <children>
                <Label text="Categories">
                    <font>
                        <Font name="System Bold" size="18.0" />
                    </font>
                </Label>
            </children>
        </VBox>
    </left>

    <center>
        <SplitPane dividerPositions="0.55" BorderPane.alignment="CENTER">
            <!-- Menu Panel (Fixed Width Columns) -->
            <VBox minWidth="500.0" spacing="10.0" style="-fx-padding: 10;">
                <children>
                    <Label text="Menu Items">
                        <font>
                            <Font name="System Bold" size="18.0" />
                        </font>
                    </Label>
                    <TableView fx:id="itemsTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="itemNameColumn" prefWidth="300.0" text="Name" resizable="false"/>
                            <TableColumn fx:id="itemPriceColumn" prefWidth="100.0" text="Price" resizable="false"/>
                            <TableColumn fx:id="itemInventoryColumn" prefWidth="100.0" text="Stock" resizable="false"/>
                        </columns>
                        <!-- Removed CONSTRAINED_RESIZE_POLICY to make column widths fixed -->
                    </TableView>
                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <children>
                            <Label text="Qty:" />
                            <Spinner fx:id="quantitySpinner" initialValue="1" max="100" min="1" prefWidth="70.0" />
                            <Button fx:id="addToCartButton" onAction="#handleAddItemToCart" text="Add to Cart" />
                        </children>
                    </HBox>
                </children>
            </VBox>

            <!-- Cart Panel (Responsive) -->
            <VBox minWidth="400.0" spacing="10.0" style="-fx-padding: 10;">
                <children>
                    <Label text="Cart">
                        <font>
                            <Font name="System Bold" size="18.0" />
                        </font>
                    </Label>
                    <TableView fx:id="cartTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="cartItemNameColumn" prefWidth="150.0" text="Item" />
                            <TableColumn fx:id="cartItemQtyColumn" prefWidth="50.0" text="Qty" />
                            <TableColumn fx:id="cartItemPriceColumn" prefWidth="80.0" text="Price" />
                            <TableColumn fx:id="cartItemTotalColumn" prefWidth="100.0" text="Total" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                    </TableView>
                    <HBox spacing="10.0">
                        <Button fx:id="removeItemButton" onAction="#handleRemoveItem" text="Remove Item" />
                        <Button fx:id="clearCartButton" onAction="#handleClearCart" text="Clear Cart" />
                    </HBox>
                    <VBox spacing="5.0" style="-fx-padding: 10; -fx-background-color: #f4f4f4; -fx-background-radius: 5;">
                        <Label text="Order Details" style="-fx-font-weight: bold;"/>
                        <Label text="Observations:" />
                        <TextArea fx:id="observationsTextArea" prefHeight="60.0" />
                        <Label text="Discount:" />
                        <HBox alignment="CENTER_LEFT" spacing="5.0">
                            <ComboBox fx:id="discountComboBox" prefWidth="150.0" />
                            <Label text="Other:" />
                            <TextField fx:id="otherDiscountField" prefWidth="60.0" />
                            <CheckBox fx:id="otherDiscountPercentageCheckBox" />
                            <Label fx:id="percentageLabel" />
                        </HBox>
                    </VBox>
                    <VBox alignment="CENTER_RIGHT" spacing="5.0" style="-fx-padding: 10;">
                        <Label fx:id="subtotalLabel" text="Subtotal: 0.00" />
                        <Label fx:id="discountLabel" text="Discount: 0.00" />
                        <Label fx:id="taxLabel" text="Tax: 0.00" />
                        <Label fx:id="totalLabel" text="Total: 0.00" style="-fx-font-size: 18; -fx-font-weight: bold;" />
                    </VBox>
                    <Button fx:id="checkoutButton" maxWidth="Infinity" onAction="#handleCheckout" text="Checkout..." />
                </children>
            </VBox>
        </SplitPane>
    </center>

    <bottom>
        <BorderPane style="-fx-padding: 5; -fx-border-color: lightgrey; -fx-border-width: 1 0 0 0;">
            <left>
                <HBox alignment="CENTER_LEFT" spacing="10.0">
                    <Label fx:id="employeeLabel" text="Employee: N/A" />
                    <Button fx:id="logoutButton" onAction="#handleLogout" text="Logout" />
                </HBox>
            </left>
            <right>
                <Button fx:id="historyButton" onAction="#handleShowHistory" text="History" />
            </right>
        </BorderPane>
    </bottom>
</BorderPane>